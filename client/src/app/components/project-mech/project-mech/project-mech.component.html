<!-- Title group  -->
<div class="title-group">
  <div class="main">
    <h1 class="mat-h1">{{projectName}} - Project Mechanical Schedule</h1>
    <button  [matMenuTriggerFor]="menu" class="top-btn-mech" mat-raised-button color="basic">
      <mat-icon>keyboard_arrow_down</mat-icon>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item [routerLink]="['/project_rev/getAll/',projectId]">
        <mat-icon>autorenew</mat-icon>
        <span>Revisions</span>
      </button>
      <button mat-menu-item [routerLink]="['/project_obj/getAll/',projectId]">
        <mat-icon>check_circle</mat-icon>
        <span>Objects</span>
      </button>
      <button mat-menu-item [routerLink]="['/project_sheet/getAll/',projectId]">
        <mat-icon>lock</mat-icon>
        <span>Register Sheet</span>
      </button>
      <button mat-menu-item  [routerLink]="['/project_mech/getAll/',projectId]"> 
        <mat-icon>schedule</mat-icon>
        <span>Mechanical Schedule</span>
      </button>
      <button mat-menu-item  [routerLink]="['/project-service-data/getAll/',projectId]"> 
        <mat-icon>schedule</mat-icon>
        <span>Electrical Schedule</span>
      </button>
      <button mat-menu-item [routerLink]="['/project_notes/getAll/',projectId]">
        <mat-icon>chat_bubble_outline</mat-icon>
        <span>Notes</span>
      </button>
      <button mat-menu-item [routerLink]="['/generate-pdf/',projectId]">
        <mat-icon>cloud_download</mat-icon>
        <span>Generate PDF</span>
      </button>               
    </mat-menu>

      <input type="file" class="top-btn mat-raised-button  custom-file-input" id="importexcel" name="importexcel"
          (change)="onFileSelect($event)" [(ngModel)]="UploadFileInput" >
      <!-- <label class="custom-file-label" for="customFile">{{fileInputLabel || 'Choose Excel'}}</label> -->
   

    <!-- <button class="top-btn" mat-raised-button color="accent" (click)="importExcel()" >Import Excel</button>  -->
    <!-- <button class="top-btn" mat-raised-button color="accent" (click)="importData()" >import sheet</button>  -->

    </div>
  <mat-divider class="mat-divider" ></mat-divider>
</div>

<div class="container view-table" >
    <div class="mat-elevation-z8">
<form [formGroup]="userTable"  >
  <table  class="table " >
    <thead class="text-nowrap">
      <tr>
        <th colspan="8"></th>
        <th colspan="9">Utility Requirement</th>
        <th colspan="5"></th>
      </tr>
      <tr>
        <th colspan="8"></th>
        <th colspan="3">TEMP</th>
        <th colspan="3">PRESSURE</th>
        <th colspan="3">FLOW</th>
        <th colspan="5"></th>
      </tr>
    <th>Component </th>
    <th>REF_NO</th>
    <th>SETTPOC</th>
    <th>Level</th>
    <th>Service Description</th>
    <th>Service Size</th>
    <th>Pipe Class</th>
    <th>Connection size</th>
    <th>Connection type</th>
    <th>MIN</th>
    <th>MAX</th>
    <th>Unit</th>
    <th>MIN</th>
    <th>MAX</th>
    <th>Unit</th>
    <th>MIN</th>
    <th>MAX</th>
    <th>Unit</th>
    <th>Service Connection</th>
    <th>End Ref No </th>
    <th>OPE</th>
    <th>Notes</th>
    <th>Action</th>

    </thead>
    <tbody>
      <ng-container *ngIf="getFormControls.controls.length <= 0">
        <tr  class="no-data">There is no Project Mechanical Sheet added yet!</tr>
      </ng-container>
      <ng-container formArrayName="tableRows" *ngFor="let group of getFormControls.controls | paginate:config ; let i=index ">
        <tr *ngIf="group.get('isEditable').value" [formGroupName]="fieldGlobalIndex(i)">
          <td>
          <mat-form-field appearance="fill">
              <mat-label>COMPONENT</mat-label>
              <mat-select  formControlName="COMPONENT_ID">
                <mat-option *ngFor="let serv of components" [value]="serv._id">
                  {{serv.COMPONENT_NAME}}
                </mat-option>
              </mat-select>
              <mat-error *ngIf="group.get('COMPONENT_ID').errors && formSubmitAttempt ">
                You must provide a<strong> Component</strong>
              </mat-error>
            </mat-form-field>
            </td>
            <td>
            <mat-form-field class="example-full-width">
              <input matInput formControlName="REF_NO">
             
            </mat-form-field>
          </td>
          <td>
            <mat-form-field class="example-full-width">
              <input matInput formControlName="SETTPOC">
             
            </mat-form-field>
          </td>
           <td>
              <mat-form-field appearance="fill">
                <mat-label>Level</mat-label>
                <mat-select  formControlName="LEVEL">
                  <mat-option *ngFor="let serv of level" [value]="serv">
                    {{serv}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
             </td>
            <td>
              <mat-form-field appearance="fill">
                <mat-label>Service Description</mat-label>
                <mat-select  formControlName="SERVICE_DESCRIPTION">
                  <mat-option *ngFor="let serv of services" [value]="serv._id">
                    {{serv.SERVICE_NAME}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="group.get('SERVICE_DESCRIPTION').errors && formSubmitAttempt ">
                  You must provide a<strong> Service</strong>
                </mat-error>
              </mat-form-field>
            </td>
            <td>
              <mat-form-field >
                <input matInput  formControlName="SERVICE_SIZE">

              </mat-form-field>
            </td>
        
            <td>
              <mat-form-field appearance="fill">
                <mat-label>Pipe Class</mat-label>
                <mat-select  formControlName="PIPE_CLASS">
                  <mat-option *ngFor="let serv of pipe_class" [value]="serv._id">
                    {{serv.PIPE_NAME}}
                  </mat-option>
                </mat-select>
                <mat-error *ngIf="group.get('PIPE_CLASS').errors && formSubmitAttempt ">
                  You must provide a<strong> Pipe Class</strong>
                </mat-error>
              </mat-form-field>
            </td>
            <td>
              <mat-form-field class="example-full-width">
                <input matInput  formControlName="CONNECTION_SIZE">
              </mat-form-field>
            </td>
           <td>
              <mat-form-field class="example-full-width">
                <input matInput  formControlName="CONNECTION_TYPE_SIZE">
              </mat-form-field>
            </td>
             <td>
                <mat-form-field class="example-full-width">
                  <input matInput  formControlName="UM_TEMP_MIN">
                  
                </mat-form-field>
              </td>
                <td>
                  <mat-form-field class="example-full-width">
                    <input matInput  formControlName="UM_TEMP_MAX">
                   
                  </mat-form-field>
                </td>
                  <td>
                    <mat-form-field class="example-full-width">
                      <input matInput  formControlName="UM_TEMP_UNIT">
                     
                    </mat-form-field>
                  </td>
                   <td>
                      <mat-form-field class="example-full-width">
                        <input matInput  formControlName="UM_PRES_MIN">
                        
                      </mat-form-field>
                    </td>
                     <td>
                        <mat-form-field class="example-full-width">
                          <input matInput  formControlName="UM_PRES_MAX">
                        
                        </mat-form-field>
                      </td>
                        <td>
                          <mat-form-field class="example-full-width">
                            <input matInput  formControlName="UM_PRES_UNIT">
                         
                          </mat-form-field>
                        </td>
                         <td>
                            <mat-form-field class="example-full-width">
                              <input matInput  formControlName="UM_FLOW_MIN">
                              
                            </mat-form-field>
                          </td>
                           <td>
                              <mat-form-field class="example-full-width">
                                <input matInput  formControlName="UM_FLOW_MAX">
                              
                              </mat-form-field>
                           </td>
                              <td>
                                <mat-form-field class="example-full-width">
                                  <input matInput  formControlName="UM_FLOW_UNIT">
                                 
                                </mat-form-field>
                              </td>
                                <td>
                                  <mat-form-field class="example-full-width">
                                    <input matInput  formControlName="SERVICE_CONN">
                                   
                                  </mat-form-field>
                                </td>
                                
                                  <td>
                                    <mat-form-field class="example-full-width">
                                      <input matInput  formControlName="END_REF_NO">
                                     
                                    </mat-form-field>
                                  </td>
                                    <td>
                                      <mat-form-field class="example-full-width">
                                        <input matInput  formControlName="OPE">
                                        
                                      </mat-form-field>
                                    </td>
                                      <td>
                                        <mat-form-field class="example-full-width">
                                          <input matInput  formControlName="NOTES">
                                         
                                        </mat-form-field>
                                      </td>
            <td>
              <div class="action-btns">
           
                <button  mat-raised-button color="primary" class="push-right"
                  (click)="doneRow(group)">Save</button>
                <button *ngIf="isDelete"  mat-raised-button color="accent" class="push-right" (click)="deleteRow(fieldGlobalIndex(i),group)">Delete</button>
                <button  mat-raised-button color="accent" (click)="cancel(group)">Cancel</button>
 
              </div>
             
            </td>
        </tr>
        <tr *ngIf="!group.get('isEditable').value" >
         
          <td>
            {{retreiveComponent(group.get('COMPONENT_ID').value)}}
          </td>
         <td>
          {{group.get('REF_NO').value}}

         </td>
         <td>{{group.get('SETTPOC') ?group.get('SETTPOC').value:''}}</td>
         <td>{{group.get('LEVEL').value}}</td>
         <td>{{retreiveService(group.get('SERVICE_DESCRIPTION').value)}}</td>
         <td>{{group.get('SERVICE_SIZE').value}}</td>
         <td>{{retreivePipeClass(group.get('PIPE_CLASS').value)}}</td>
         <td>{{group.get('CONNECTION_SIZE').value}}</td>
         <td>{{group.get('CONNECTION_TYPE_SIZE').value}}</td>
         <td>{{group.get('UM_TEMP_MIN').value}}</td>
         <td>{{group.get('UM_TEMP_MAX').value}}</td>
         <td>{{group.get('UM_TEMP_UNIT').value}}</td>
         <td>{{group.get('UM_PRES_MIN').value}}</td>
         <td>{{group.get('UM_PRES_MAX').value}}</td>
         <td>{{group.get('UM_PRES_UNIT').value}}</td>
         <td>{{group.get('UM_FLOW_MIN').value}}</td>
         <td>{{group.get('UM_FLOW_MAX').value}}</td>
         <td>{{group.get('UM_FLOW_UNIT').value}}</td>
         <td>{{group.get('SERVICE_CONN').value}}</td>
         <td>{{group.get('END_REF_NO').value}}</td>
         <td>{{group.get('OPE').value}}</td>
         <td>{{group.get('NOTES').value}}</td>



          <td>
            <div class="action-btns">
            <button  mat-raised-button color="primary" class="push-right"
            (click)="editRow(group)">Edit</button>
            </div>
          </td>
        </tr>
      </ng-container>
    </tbody>
    <div class="action-container">
      <button mat-raised-button type="submit" color="primary" (click)="addRow()">Add row</button>
    </div>
    <div style="float:right">
    <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
</div>
  </table>
  
</form>

</div>

</div>
