<!-- Title group  -->
<div class="title-group">
    <div class="main">
      <h1 class="mat-h1">{{projectName}} - Project Register Sheets</h1>
      <button  [matMenuTriggerFor]="menu" class="top-btn" mat-raised-button color="basic">
        <mat-icon>keyboard_arrow_down</mat-icon>
      </button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item [routerLink]="['/project_rev/getAll/',projectId]">
          <mat-icon>autorenew</mat-icon>
          <span>Revisions</span>
        </button>
        <button mat-menu-item [routerLink]="['/project_obj/getAll/',projectId]">
          <mat-icon>check_circle</mat-icon>
          <span>Objects</span>
        </button>
        <button mat-menu-item [routerLink]="['/project_sheet/getAll/',projectId]">
          <mat-icon>lock</mat-icon>
          <span>Register Sheet</span>
        </button>
        <button mat-menu-item  [routerLink]="['/project_mech/getAll/',projectId]"> 
          <mat-icon>schedule</mat-icon>
          <span>Mechanical Schedule</span>
        </button>
        <button mat-menu-item  [routerLink]="['/project-service-data/getAll/',projectId]"> 
          <mat-icon>schedule</mat-icon>
          <span>Electrical Schedule</span>
        </button>
        <button mat-menu-item [routerLink]="['/project_notes/getAll/',projectId]">
          <mat-icon>chat_bubble_outline</mat-icon>
          <span>Notes</span>
        </button>
        <button mat-menu-item [routerLink]="['/generate-pdf/',projectId]">
          <mat-icon>cloud_download</mat-icon>
          <span>Generate PDF</span>
        </button>               
      </mat-menu>
  
      </div>
    <mat-divider class="mat-divider" ></mat-divider>

    <input type="file" class="top-btn mat-raised-button  custom-file-input" id="importexcel" name="importexcel"
          (change)="onFileSelect($event)" [(ngModel)]="UploadFileInput" >
  </div>

  
  
  <div class="container view-table" style="margin-top: 70px;" >
      <div class="mat-elevation-z8">
  <form [formGroup]="userTable">
    <table  class="table ">
      <thead class="text-nowrap">
        <th>Item Name </th>
        <th>Description A</th>
        <th>Description B</th>
        <th>Description C</th>
        <th>Section</th>
        <th>Item No</th>
        <th>Date Issued</th>
        <th>Rev issued</th>
        <th>Action</th>

      </thead>
      <tbody>
       
        <ng-container formArrayName="tableRows" *ngFor="let group of getFormControls.controls | paginate:config ; let i=index">
          <tr *ngIf="group.get('isEditable').value" [formGroupName]="fieldGlobalIndex(i)">
            <td>
              <mat-form-field>
                <input matInput type="text" formControlName="ITEM_NAME">
                <mat-error *ngIf="group.get('ITEM_NAME').errors && formSubmitAttempt ">
                  You must provide a<strong> Item name</strong>
                </mat-error>
              </mat-form-field>
            </td>
            <td>
              <mat-form-field>
                <input matInput type="text" formControlName="DESCRIPTION_A">
                <mat-error *ngIf="group.get('DESCRIPTION_A').errors && formSubmitAttempt ">
                  You must provide a<strong> Description</strong>
                </mat-error>
              </mat-form-field>
            </td>
            <td>
                <mat-form-field>
                  <input matInput type="text" formControlName="DESCRIPTION_B">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field>
                  <input matInput type="text" formControlName="DESCRIPTION_C">
                </mat-form-field>
              </td>
              <td>
                <mat-form-field >
                    <mat-label>Section</mat-label>
                    <mat-select  formControlName="SECTION">
                      <mat-option *ngFor="let serv of section" [value]="serv">
                        {{serv}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="group.get('SECTION').errors && formSubmitAttempt ">
                      You must provide a<strong> Section</strong>
                    </mat-error>
                  </mat-form-field>
              </td>
              <td>
                <mat-form-field >
                    <mat-label>Item No</mat-label>
                    <mat-select formControlName="ITEM_NO">
                      <mat-option *ngFor="let comp of item_no" [value]="comp">
                        {{comp}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="group.get('ITEM_NO').errors && formSubmitAttempt ">
                      You must provide a<strong> ITEM_NO</strong>
                    </mat-error>
                  </mat-form-field>
              </td>
              <td>
                <mat-form-field>
                    <input matInput matInput [matDatepicker]="picker" formControlName="DATE_ISSUED"  (dateChange)="formatDate($event,group)">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                    <mat-error *ngIf="group.get('DATE_ISSUED').errors && formSubmitAttempt ">
                      You must provide a<strong> Date issued</strong>
                    </mat-error>
                </mat-form-field>
              </td>
              <td>
                <mat-form-field>
                  <input matInput type="text" formControlName="REV_ISSUED">

                </mat-form-field>
              </td>
            
              <td>
                 <div class="action-btns">
           
                <button  mat-raised-button color="primary" class="push-right"
                  (click)="doneRow(group)">Save</button>
                <button *ngIf="isDelete" mat-raised-button color="accent" (click)="deleteRow(fieldGlobalIndex(i),group)" class="push-right">Delete</button>
                <button  mat-raised-button color="accent" (click)="cancel(group)">Cancel</button>
 
              </div>
             
              </td>
          </tr>
          <tr *ngIf="!group.get('isEditable').value" >
           
            <td>
              {{group.get('ITEM_NAME').value}}
            </td>
            <td>
                {{group.get('DESCRIPTION_A').value}}
            </td>
            <td>
                {{group.get('DESCRIPTION_B').value}}
            </td>
            <td>
              {{group.get('DESCRIPTION_C').value}}
            </td>
            <td>
                {{group.get('SECTION').value}}
              </td>
              <td>
                {{group.get('ITEM_NO').value}}
              </td>
              <td>
                {{group.get('DATE_ISSUED').value}}
              </td>
              <td>
                {{group.get('REV_ISSUED').value}}
              </td>
            <td>
              <div class="action-btns">
                <button  mat-raised-button color="primary" class="push-right"
                (click)="editRow(group)">Edit</button>
                </div>      
                </td>
          </tr>
        </ng-container>
      </tbody>
      <div class="action-container">
        <button mat-raised-button type="submit" color="primary" (click)="addRow()">Add row</button>
      </div>
      <div style="float:right">
        <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
    </div>
    </table>
   
  </form>
  </div>
  
  </div>
  